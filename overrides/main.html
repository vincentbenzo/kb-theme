{% extends "base.html" %}

{% block extrahead %}
{{ super() }}
<meta name="custom-override" content="active">
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
  // Function to handle workspace selection change
  function changeWorkspace(workspacePath) {
    if (workspacePath) {
      // Navigate to the selected workspace
      window.location.href = workspacePath;
    }
  }

  document.addEventListener('DOMContentLoaded', function() {
    // Create the workspace selector
    const selectorContainer = document.createElement('div');
    selectorContainer.className = 'workspace-selector'; // Changed from workspace-selector-inline
    
    const selectElement = document.createElement('select');
    selectElement.id = 'workspace-dropdown';
    selectElement.setAttribute('onchange', 'changeWorkspace(this.value)');
    selectElement.setAttribute('aria-label', 'Select workspace');
    
    // Add options with FULL URLs for separate repositories
    const options = [
      { value: 'https://vincentbenzo.github.io/kb-platform/', text: 'Main' },
      { value: 'https://vincentbenzo.github.io/kb-engineering/', text: 'Engineering' },
      { value: 'https://vincentbenzo.github.io/kb-grc/', text: 'GRC' },
      { value: 'https://vincentbenzo.github.io/kb-networking/', text: 'Networking' }
    ];
    
    options.forEach(option => {
      const optionElement = document.createElement('option');
      optionElement.value = option.value;
      optionElement.textContent = option.text;
      selectElement.appendChild(optionElement);
    });
    
    selectorContainer.appendChild(selectElement);
    
    // Find where to insert the workspace selector - after the site title
    const headerTitle = document.querySelector('.md-header__title');
    if (headerTitle && headerTitle.parentNode) {
      headerTitle.parentNode.insertBefore(selectorContainer, headerTitle.nextSibling);
    }
    
    // Set the current workspace in dropdown based on full URL
    const currentUrl = window.location.href;
    
    for (let i = 0; i < selectElement.options.length; i++) {
      if (currentUrl.includes(selectElement.options[i].value)) {
        selectElement.selectedIndex = i;
        break;
      }
    }
  });
</script>
{% endblock %}
